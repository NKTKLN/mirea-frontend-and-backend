# Shop API

Это API и веб-приложение на Node.js для управления продуктами. Оно включает основные операции CRUD (создание, чтение, обновление и удаление) и автоматическую документацию API с использованием Swagger. Приложение состоит из двух частей: сервер API, веб-интерфейс для управления продуктами и чат с использованием WebSocket.

## Функции

- **Управление продуктами:** Создание, чтение, обновление и удаление продуктов.
- **Документация Swagger:** Автоматически генерируемая документация для API.
- **Веб-интерфейс:** Простой интерфейс для просмотра, добавления и редактирования продуктов.
- **Чат через WebSocket:** Чат с возможностью отправлять сообщения только текущему пользователю через WebSocket-соединение.

---

## Установка и настройка

Следуйте этим шагам, чтобы установить и запустить приложение локально.

### Требования

- Node.js (>= 12.x)
- npm (Node Package Manager)

### Шаг 1: Клонируйте репозиторий

```bash
git clone https://github.com/NKTKLN/mirea-frontend-and-backend
cd mirea-frontend-and-backend/rest-api
```

### Шаг 2: Установите зависимости

Запустите следующую команду для установки всех необходимых зависимостей:

```bash
npm install
```

### Шаг 3: Настройка базы данных (по желанию)

Приложение использует файл `db.json` для хранения продуктов. Вы можете оставить его как есть, и он будет создан автоматически при первом запуске приложения.

### Шаг 4: Запуск приложения

Чтобы запустить сервер API и веб-приложение, используйте команду:

```bash
node server.js
```

По умолчанию:
- **API сервер** будет работать на порту `8080`.
- **Веб-приложение** будет работать на порту `3000`.
- **GraphQL сервер** будет работать на порту `4000`.
- **WebSocket сервер** будет работать на порту `5000`.

### Шаг 5: Доступ к приложению

- **Документация API:** Откройте `http://localhost:8080/api/docs` в браузере, чтобы просмотреть Swagger UI с документацией API.
- **Веб-интерфейс:** Откройте `http://localhost:3000` в браузере для взаимодействия с интерфейсом управления продуктами.
- **GraphQL интерфейс:** Откройте `http://localhost:4000` для использования GraphQL запросов.
- **Чат через WebSocket:** Вы можете взаимодействовать с чатом через WebSocket на порту `5000` (сообщения будут отправляться только текущему пользователю).

---

## API Эндпоинты

### 1. Получить все продукты

- **GET** `/api/products`
- **Ответ:** Список всех продуктов.

### 2. Получить продукт по ID

- **GET** `/api/products/{id}`
- **Ответ:** Продукт по ID.

### 3. Добавить новый продукт

- **POST** `/api/products`
- **Тело запроса:**
  ```json
  {
    "name": "Название продукта",
    "price": 99.99,
    "description": "Описание продукта"
  }
  ```
- **Ответ:** Новый созданный продукт.

### 4. Обновить существующий продукт

- **PUT** `/api/products/{id}`
- **Тело запроса:**
  ```json
  {
    "name": "Обновленное название продукта",
    "price": 79.99,
    "description": "Обновленное описание"
  }
  ```
- **Ответ:** Обновленный продукт.

### 5. Удалить продукт

- **DELETE** `/api/products/{id}`
- **Ответ:** Статус 204 (No Content) при успешном удалении.

---

## Документация Swagger

API использует [Swagger](https://swagger.io/) для автоматической генерации документации. Вы можете просмотреть документацию API, перейдя по следующему URL в браузере:

- [Swagger UI](http://localhost:8080/api/docs)

---

## WebSocket для чата

Приложение поддерживает чат через WebSocket, позволяя пользователям отправлять сообщения, которые будут видны только им. Сообщения выводятся в консоль при получении.

- **WebSocket сервер** работает на порту `5000`.
- Каждое сообщение, отправленное через WebSocket, будет отправляться обратно только тому пользователю, который его отправил.

---

## Примечания

- Приложение использует WebSocket для общения между сервером и клиентом, что позволяет реализовать чат в реальном времени.
- Для того чтобы взаимодействовать с GraphQL, вам нужно отправлять запросы на порт `4000`.
